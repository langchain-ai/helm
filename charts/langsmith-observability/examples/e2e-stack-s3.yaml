# Use this configuration to deploy the full LangSmith observability stack with in-cluster storage.
# You can disable parts as you see fit, such as exporters, or logs/metrics/traces.
# NOTE: This configuration is not recommended for production environments.

langsmithNamespace: "langsmith" # Change this value to match your LangSmith namespace.
langSmithReleaseName: "langsmith" # Change this value to match your LangSmith release name.

# ======================== Metrics Exporters ========================
kubestatemetrics:
  enabled: true
  # Change this value to match your LangSmith namespace.
  namespaces: "langsmith"

postgresexporter:
  enabled: true
  config:
    # Change these values to match your Postgres instance.
    datasource:
      host: langsmith-postgres.langsmith.svc.cluster.local
      user: postgres
      password: postgres
      database: postgres
      port: "5432"

nginxexporter:
  enabled: true
  # Change this value to match your LangSmith frontend service.
  nginxServer: "http://langsmith-frontend.langsmith.svc.cluster.local:80/nginx_status"

redisexporter:
  enabled: true
  # Change this value to match your Redis instance.
  redisAddress: langsmith-redis.langsmith.svc.cluster.local:6379

# ======================== OTEL Collector ========================
otelCollector:
  logs:
    enabled: true
  metrics:
    enabled: true
  traces:
    enabled: true
    
# ======================== LGTM Stack ========================
# Telemetry visualization tool
grafana:
  enabled: true

# Logging storage + retrieval
loki:
  enabled: true
  loki:
    storage:
      type: s3
      # Modify these values do match your S3 bucket.
      bucketNames:
        chunks: langsmith-lgtm-stack
        ruler: langsmith-lgtm-stack
      s3:
        endpoint: s3.${REGION}.amazonaws.com # Change this value to match your S3 endpoint.
        region: ${REGION} # Change this value to match your S3 region.
        secretAccessKey: ${SECRET_ACCESS_KEY} # Change this value to match your S3 secret key.
        accessKeyId: ${ACCESS_KEY_ID} # Change this value to match your S3 access key.
        insecure: false
        s3ForcePathStyle: false

    storage_config:
      object_prefix: loki
      aws:
        region: ${REGION}
        bucketnames: ${BUCKET_NAME}
        s3forcepathstyle: false
        
# Metrics storage + retrieval
mimir:
  enabled: true
  mimir:
    structuredConfig:
      common:
        # Modify these values do match your S3 bucket.
         storage:
          backend: s3
          s3:
            endpoint: "s3.${REGION}.amazonaws.com" # Change this value to match your S3 endpoint.
            bucket_name: ${BUCKET_NAME} # Change this value to match your S3 bucket.
            region: ${REGION} # Change this value to match your S3 region.
            secret_access_key: ${SECRET_ACCESS_KEY} # Change this value to match your S3 secret key.
            access_key_id: ${ACCESS_KEY_ID} # Change this value to match your S3 access key.
            insecure: false 

      blocks_storage:
        storage_prefix: mimirBlocks

      alertmanager_storage:
        storage_prefix: mimirAlertmanager

      ruler_storage:
        storage_prefix: mimirRuler

# Traces storage + retrieval
tempo:
  enabled: true
  storage:
    trace:
      backend: s3
      s3:
        access_key: ${ACCESS_KEY_ID} # Change this value to match your S3 access key.
        secret_key: ${SECRET_ACCESS_KEY} # Change this value to match your S3 secret key.
        bucket: ${BUCKET_NAME} # Change this value to match your S3 bucket. 
        endpoint: s3.${REGION}.amazonaws.com # Change this value to match your S3 endpoint.
        insecure: false
        prefix: tempo # Prefix in the s3 bucket to write data to.